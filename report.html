<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gallery 13 | –°—É—Ç–æ—á–Ω—ã–π –æ—Ç—á–µ—Ç</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <header class="gallery-header">
            <div class="header-left">
                <button class="btn-icon back-btn" onclick="window.location.href='dashboard.html'">
                    ‚Üê
                </button>
                <div class="gallery-brand">
                    <span class="brand-icon">üìä</span>
                    <div>
                        <h1>–°—É—Ç–æ—á–Ω—ã–π –æ—Ç—á–µ—Ç</h1>
                        <p class="brand-subtitle">Gallery 13 Work Space</p>
                    </div>
                </div>
            </div>
            
            <div class="report-actions">
                <button class="btn-icon" onclick="saveDraft()" title="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —á–µ—Ä–Ω–æ–≤–∏–∫">
                    üíæ
                </button>
                <button class="btn-icon" onclick="loadTemplate()" title="–ó–∞–≥—Ä—É–∑–∏—Ç—å —à–∞–±–ª–æ–Ω">
                    üìã
                </button>
            </div>
        </header>

        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—Ç—á–µ—Ç–µ -->
        <div class="report-info">
            <div class="info-item">
                <span class="info-label">–î–∞—Ç–∞:</span>
                <span id="report-date" class="info-value"></span>
            </div>
            <div class="info-item">
                <span class="info-label">–°–º–µ–Ω–∞:</span>
                <select id="shift-select" class="info-value">
                    <option value="day">–î–Ω–µ–≤–Ω–∞—è (10:00-18:00)</option>
                    <option value="evening">–í–µ—á–µ—Ä–Ω—è—è (18:00-22:00)</option>
                    <option value="full">–ü–æ–ª–Ω–∞—è (10:00-22:00)</option>
                </select>
            </div>
            <div class="info-item">
                <span class="info-label">–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π:</span>
                <span id="report-employee" class="info-value"></span>
            </div>
        </div>

        <form id="report-form">
            <!-- –°–µ–∫—Ü–∏—è 1: –§–∏–Ω–∞–Ω—Å—ã -->
            <div class="section-card">
                <div class="section-header">
                    <span class="section-icon">üí∞</span>
                    <h2>–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –æ—Ç—á–µ—Ç</h2>
                </div>
                
                <div class="finance-grid">
                    <div class="finance-item">
                        <label>–ù–∞–ª–∏—á–Ω—ã–µ –≤ –∫–∞—Å—Å–µ</label>
                        <input type="number" id="cash-start" placeholder="–ù–∞—á–∞–ª—å–Ω–∞—è —Å—É–º–º–∞" required>
                        <input type="number" id="cash-end" placeholder="–ö–æ–Ω–µ—á–Ω–∞—è —Å—É–º–º–∞" required>
                    </div>
                    
                    <div class="finance-item">
                        <label>–ë–µ–∑–Ω–∞–ª–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏</label>
                        <input type="number" id="terminal-amount" placeholder="–°—É–º–º–∞ –ø–æ —Ç–µ—Ä–º–∏–Ω–∞–ª—É">
                        <select id="terminal-status">
                            <option value="ok">–¢–µ—Ä–º–∏–Ω–∞–ª —Ä–∞–±–æ—Ç–∞–µ—Ç</option>
                            <option value="issues">–ï—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã</option>
                            <option value="offline">–ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç</option>
                        </select>
                    </div>
                    
                    <div class="finance-item">
                        <label>–†–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è</label>
                        <textarea id="discrepancies" placeholder="–û–ø–∏—à–∏—Ç–µ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è, –µ—Å–ª–∏ –µ—Å—Ç—å" rows="2"></textarea>
                    </div>
                </div>
            </div>

            <!-- –°–µ–∫—Ü–∏—è 2: –í–∏—Ç—Ä–∏–Ω—ã –∏ —Ç–æ–≤–∞—Ä -->
            <div class="section-card">
                <div class="section-header">
                    <span class="section-icon">üëú</span>
                    <h2>–í–∏—Ç—Ä–∏–Ω—ã –∏ —Ç–æ–≤–∞—Ä</h2>
                </div>
                
                <div class="showcases-grid">
                    <div class="showcase-item">
                        <h3>–û—Å–Ω–æ–≤–Ω–∞—è –≤–∏—Ç—Ä–∏–Ω–∞</h3>
                        <select class="showcase-status">
                            <option value="">–°–æ—Å—Ç–æ—è–Ω–∏–µ</option>
                            <option value="perfect">–ò–¥–µ–∞–ª—å–Ω–æ</option>
                            <option value="good">–•–æ—Ä–æ—à–æ</option>
                            <option value="needs_cleaning">–ù—É–∂–Ω–∞ —É–±–æ—Ä–∫–∞</option>
                            <option value="needs_restock">–ù—É–∂–Ω–æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ</option>
                        </select>
                        <textarea placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..." rows="2"></textarea>
                    </div>
                    
                    <div class="showcase-item">
                        <h3>VIP –≤–∏—Ç—Ä–∏–Ω–∞</h3>
                        <select class="showcase-status">
                            <option value="">–°–æ—Å—Ç–æ—è–Ω–∏–µ</option>
                            <option value="perfect">–ò–¥–µ–∞–ª—å–Ω–æ</option>
                            <option value="good">–•–æ—Ä–æ—à–æ</option>
                            <option value="needs_cleaning">–ù—É–∂–Ω–∞ —É–±–æ—Ä–∫–∞</option>
                            <option value="needs_restock">–ù—É–∂–Ω–æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ</option>
                        </select>
                        <textarea placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..." rows="2"></textarea>
                    </div>
                    
                    <div class="showcase-item">
                        <h3>–°–∫–ª–∞–¥</h3>
                        <select class="showcase-status">
                            <option value="">–°–æ—Å—Ç–æ—è–Ω–∏–µ</option>
                            <option value="organized">–£–ø–æ—Ä—è–¥–æ—á–µ–Ω–æ</option>
                            <option value="messy">–ë–µ—Å–ø–æ—Ä—è–¥–æ–∫</option>
                            <option value="needs_inventory">–ù—É–∂–Ω–∞ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è</option>
                        </select>
                        <textarea placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..." rows="2"></textarea>
                    </div>
                </div>
            </div>

            <!-- –°–µ–∫—Ü–∏—è 3: –§–æ—Ç–æ–æ—Ç—á–µ—Ç -->
            <div class="section-card">
                <div class="section-header">
                    <span class="section-icon">üì∏</span>
                    <h2>–§–æ—Ç–æ–æ—Ç—á–µ—Ç</h2>
                    <p class="section-subtitle">–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ–æ—Ç–æ –¥–ª—è –æ—Ç—á–µ—Ç–∞</p>
                </div>
                
                <div class="photo-requirements">
                    <div class="requirement-item">
                        <span class="req-icon">‚úÖ</span>
                        <span>–ö–∞—Å—Å–∞ (–æ—Ç–∫—Ä—ã—Ç–∞—è/–∑–∞–∫—Ä—ã—Ç–∞—è)</span>
                    </div>
                    <div class="requirement-item">
                        <span class="req-icon">‚úÖ</span>
                        <span>–û–±—â–∏–π –≤–∏–¥ –∑–∞–ª–∞</span>
                    </div>
                    <div class="requirement-item">
                        <span class="req-icon">‚úÖ</span>
                        <span>–°–æ—Å—Ç–æ—è–Ω–∏–µ –≤–∏—Ç—Ä–∏–Ω</span>
                    </div>
                </div>
                
                <div class="photo-upload-grid">
                    <div class="photo-upload-card" onclick="takePhoto('cash')">
                        <div class="photo-upload-icon">‚ûï</div>
                        <p>–ö–∞—Å—Å–∞</p>
                        <small>–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ</small>
                    </div>
                    
                    <div class="photo-upload-card" onclick="takePhoto('main_showcase')">
                        <div class="photo-upload-icon">‚ûï</div>
                        <p>–û—Å–Ω–æ–≤–Ω–∞—è –≤–∏—Ç—Ä–∏–Ω–∞</p>
                        <small>–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ</small>
                    </div>
                    
                    <div class="photo-upload-card" onclick="takePhoto('vip_showcase')">
                        <div class="photo-upload-icon">‚ûï</div>
                        <p>VIP –≤–∏—Ç—Ä–∏–Ω–∞</p>
                        <small>–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ</small>
                    </div>
                    
                    <div class="photo-upload-card" onclick="takePhoto('general_view')">
                        <div class="photo-upload-icon">‚ûï</div>
                        <p>–û–±—â–∏–π –≤–∏–¥</p>
                        <small>–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ</small>
                    </div>
                    
                    <div class="photo-upload-card" onclick="takePhoto('problems')">
                        <div class="photo-upload-icon">‚ûï</div>
                        <p>–ü—Ä–æ–±–ª–µ–º–Ω—ã–µ –º–µ—Å—Ç–∞</p>
                        <small>–ï—Å–ª–∏ –µ—Å—Ç—å</small>
                    </div>
                    
                    <div class="photo-upload-card" onclick="takePhoto('other')">
                        <div class="photo-upload-icon">‚ûï</div>
                        <p>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ</p>
                        <small>–ü–æ –∂–µ–ª–∞–Ω–∏—é</small>
                    </div>
                </div>
                
                <div id="photo-preview" class="photo-preview"></div>
            </div>

            <!-- –°–µ–∫—Ü–∏—è 4: –ò–Ω—Ü–∏–¥–µ–Ω—Ç—ã –∏ –∑–∞–º–µ—á–∞–Ω–∏—è -->
            <div class="section-card">
                <div class="section-header">
                    <span class="section-icon">‚ö†Ô∏è</span>
                    <h2>–ò–Ω—Ü–∏–¥–µ–Ω—Ç—ã –∏ –∑–∞–º–µ—á–∞–Ω–∏—è</h2>
                </div>
                
                <div class="form-group">
                    <label>–ü—Ä–æ–±–ª–µ–º—ã –≤ —Ç–µ—á–µ–Ω–∏–µ —Å–º–µ–Ω—ã</label>
                    <textarea id="incidents" placeholder="–û–ø–∏—à–∏—Ç–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã, –ø–æ–ª–æ–º–∫–∏, –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã..." rows="4"></textarea>
                </div>
                
                <div class="form-group">
                    <label>–ü–æ—Ç–µ—Ä–∏/–±—Ä–∞–∫</label>
                    <textarea id="losses" placeholder="–£–∫–∞–∂–∏—Ç–µ –ø–æ—Ç–µ—Ä–∏ —Ç–æ–≤–∞—Ä–∞ –∏–ª–∏ –±—Ä–∞–∫..." rows="3"></textarea>
                </div>
                
                <div class="form-group">
                    <label>–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—é</label>
                    <textarea id="suggestions" placeholder="–í–∞—à–∏ –∏–¥–µ–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã..." rows="3"></textarea>
                </div>
            </div>

            <!-- –ö–Ω–æ–ø–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ -->
            <div class="action-buttons">
                <button type="button" class="btn btn-secondary" onclick="saveDraft()">
                    <span class="btn-icon">üíæ</span>
                    –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —á–µ—Ä–Ω–æ–≤–∏–∫
                </button>
                
                <button type="button" class="btn btn-secondary" onclick="previewReport()">
                    <span class="btn-icon">üëÅÔ∏è</span>
                    –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä
                </button>
                
                <button type="submit" class="btn btn-primary">
                    <span class="btn-icon">üì§</span>
                    –û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç—á–µ—Ç
                </button>
            </div>
        </form>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
            if (!window.currentEmployee) {
                window.location.href = 'index.html';
                return;
            }

            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –¥–∞—Ç—É
            const now = new Date();
            document.getElementById('report-date').textContent = 
                now.toLocaleDateString('ru-RU', {
                    day: 'numeric',
                    month: 'long',
                    year: 'numeric',
                    weekday: 'long'
                });

            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
            document.getElementById('report-employee').textContent = 
                window.currentEmployee.name;

            // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º—ã
            document.getElementById('report-form').addEventListener('submit', function(e) {
                e.preventDefault();
                submitReport();
            });

            // –ó–∞–≥—Ä—É–∑–∫–∞ —à–∞–±–ª–æ–Ω–∞ –∏–∑ URL
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.has('template')) {
                loadTemplate(urlParams.get('template'));
            }
        });

        function submitReport() {
            const reportData = {
                timestamp: new Date().toISOString(),
                employee: window.currentEmployee,
                location: window.currentEmployee.location,
                shift: document.getElementById('shift-select').value,
                finance: {
                    cashStart: document.getElementById('cash-start').value,
                    cashEnd: document.getElementById('cash-end').value,
                    terminalAmount: document.getElementById('terminal-amount').value,
                    terminalStatus: document.getElementById('terminal-status').value,
                    discrepancies: document.getElementById('discrepancies').value
                },
                showcases: Array.from(document.querySelectorAll('.showcase-item')).map(item => ({
                    name: item.querySelector('h3').textContent,
                    status: item.querySelector('.showcase-status').value,
                    comment: item.querySelector('textarea').value
                })),
                incidents: document.getElementById('incidents').value,
                losses: document.getElementById('losses').value,
                suggestions: document.getElementById('suggestions').value
            };

            // –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç—á–µ—Ç–∞
            sendReportToTelegram(reportData);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            showSuccessNotification('–û—Ç—á–µ—Ç —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É Gallery 13');
            
            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –Ω–∞ –¥–∞—à–±–æ—Ä–¥ —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                window.location.href = 'dashboard.html';
            }, 2000);
        }

        function takePhoto(type) {
            // –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∫–∞–º–µ—Ä–æ–π Telegram
            if (window.Telegram?.WebApp) {
                window.Telegram.WebApp.showPopup({
                    title: '–î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ',
                    message: `–°–¥–µ–ª–∞–π—Ç–µ —Ñ–æ—Ç–æ –¥–ª—è: ${type}`,
                    buttons: [
                        { type: 'default', text: '–°–¥–µ–ª–∞—Ç—å —Ñ–æ—Ç–æ' },
                        { type: 'cancel', text: '–û—Ç–º–µ–Ω–∞' }
                    ]
                });
            }
            
            // –î–ª—è –¥–µ–º–æ
            addPhotoPlaceholder(type);
        }

        function addPhotoPlaceholder(type) {
            const preview = document.getElementById('photo-preview');
            const photoItem = document.createElement('div');
            photoItem.className = 'preview-photo';
            photoItem.innerHTML = `
                <img src="https://via.placeholder.com/120/1e293b/8b5cf6?text=${encodeURIComponent(type)}" 
                     alt="${type}">
                <div class="photo-info">
                    <strong>${type}</strong>
                    <small>${new Date().toLocaleTimeString()}</small>
                </div>
                <button class="remove-photo" onclick="this.parentElement.remove()">‚úï</button>
            `;
            preview.appendChild(photoItem);
        }

        function saveDraft() {
            alert('–ß–µ—Ä–Ω–æ–≤–∏–∫ –æ—Ç—á–µ—Ç–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω –ª–æ–∫–∞–ª—å–Ω–æ');
            // –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ localStorage
        }

        function loadTemplate(templateName = 'daily') {
            const templates = {
                daily: {
                    shift: 'full',
                    incidents: '–ò–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤ –Ω–µ –±—ã–ª–æ',
                    suggestions: ''
                },
                open: {
                    shift: 'day',
                    incidents: '',
                    suggestions: ''
                },
                close: {
                    shift: 'evening',
                    incidents: '',
                    suggestions: ''
                }
            };
            
            const template = templates[templateName];
            if (template) {
                document.getElementById('shift-select').value = template.shift;
                document.getElementById('incidents').value = template.incidents;
                document.getElementById('suggestions').value = template.suggestions;
                
                showSuccessNotification(`–®–∞–±–ª–æ–Ω "${templateName}" –∑–∞–≥—Ä—É–∂–µ–Ω`);
            }
        }

        function previewReport() {
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–æ–º
            alert('–§—É–Ω–∫—Ü–∏—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ');
        }

        function sendReportToTelegram(data) {
            console.log('–û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç—á–µ—Ç–∞ –≤ Telegram:', data);
            // –†–µ–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram Bot API
        }

        function showSuccessNotification(message) {
            // –°–æ–∑–¥–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            const notification = document.createElement('div');
            notification.className = 'success-notification';
            notification.innerHTML = `
                <span class="notification-icon">‚úÖ</span>
                <span>${message}</span>
            `;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: var(--accent-green);
                color: white;
                padding: 16px 24px;
                border-radius: 12px;
                box-shadow: 0 8px 24px rgba(16, 185, 129, 0.3);
                z-index: 1000;
                animation: slideIn 0.3s ease-out;
            `;
            
            document.body.appendChild(notification);
            
            // –£–¥–∞–ª—è–µ–º —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease-out';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>